
/*
(venv) tingqian@odt-huyuan-openvino-ci-68:~$
OV_CPU_DEBUG_LOG= MATCHER_VERBOSE=0 VNODE_WLIST=gptneox_attention, USE_REF=3  numactl --localalloc -C 0-47 python3 ~/llm_internal_test/public/benchmark.py -m /home/llm_irs/models/opt-2.7b/onnx/dldt/FP32/ -t "What is Oxygen?"

['What is Oxygen?\n\nOxygen is a gas that is essential for life. It is the most abundant element in the universe, and is found in all living things. It is also the most abundant element in the human body.\n\nOxygen is produced by the breakdown of carbon dioxide, a gas that is produced by the breakdown of food.\n\nOxygen is a colorless, odorless, tasteless gas. It is a colorless gas because it is made up of only one atom of hydrogen and one atom of oxygen.\n\nOxygen is a colorless gas because it is made up of only one atom']

OPTForCausalLM

*/
OutputVector vnode_opt_attn(const OutputVector& inputs) {
    int ii = 0;

    // _decoder_layers_1_self_attn_v_proj_Add   : "f32[?,?,2560]"   v_proj
    // _decoder_layers_1_self_attn_k_proj_Add   : "f32[?,?,2560]"   k_proj
    // _decoder_layers_1_self_attn_Mul          : "f32[?,?,2560]"   q_proj
    // auto past_key_values_1_value = GenPattern<opset1::Parameter>({}, "f32[?,32,?,80]", {{"shape", "[?,32,?,80]"}, {"element_type", "f32"}});   //  past_key_values.1.value
    // auto past_key_values_1_key = GenPattern<opset1::Parameter>({}, "f32[?,32,?,80]", {{"shape", "[?,32,?,80]"}, {"element_type", "f32"}});   //  past_key_values.1.key
    // auto _decoder_Add_2 = GenPattern<opset1::Broadcast>({Add_85865, Maximum_85867, Constant_145033}, "f32[?,1,?,?]", {{"mode", "numpy"}});   //  /decoder/Add_2
    // auto _decoder_layers_1_self_attn_Shape = GenPattern<opset1::ShapeOf>({_decoder_layers_1_self_attn_layer_norm_Add_1}, "i32[3]", {{"type_relax", 1}, {"input_data_types", "[]"}, {"output_data_types", "[i32]"}});   //  /decoder/layers.1/self_attn/Shape

    auto _decoder_layers_1_self_attn_Shape = inputs[ii++];

    auto _decoder_layers_1_self_attn_Mul = inputs[ii++];
    auto _decoder_layers_1_self_attn_k_proj_Add = inputs[ii++];
    auto _decoder_layers_1_self_attn_v_proj_Add = inputs[ii++];
    auto past_key_values_1_key = inputs[ii++];
    auto past_key_values_1_value = inputs[ii++];
    auto _decoder_Add_2 = inputs[ii++];                // attention mask + causal mask

    auto Gather_103550 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {0, 1}, 0}, "i32[2]", {{"batch_dims", 0}});   //  Gather_103550
    auto _decoder_layers_1_self_attn_Concat_4 = GenPattern<opset1::Concat>({Gather_103550, {32}, {80}}, "i32[4]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_4
    auto _decoder_layers_1_self_attn_Reshape_2 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Mul, _decoder_layers_1_self_attn_Concat_4}, "f32[?,?,32,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_2

    auto _decoder_layers_1_self_attn_Transpose_2 = GenPattern<opset1::Transpose>({_decoder_layers_1_self_attn_Reshape_2, {0, 2, 1, 3}}, "f32[?,32,?,80]");   //  /decoder/layers.1/self_attn/Transpose_2
    auto _decoder_layers_1_self_attn_Gather = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, 0, 0}, "i32[]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather
    auto _decoder_layers_1_self_attn_Mul_1 = GenPattern<opset1::Multiply>({_decoder_layers_1_self_attn_Gather, 32}, "i32[]", {{"auto_broadcast", "numpy"}});   //  /decoder/layers.1/self_attn/Mul_1
    auto _decoder_layers_1_self_attn_Unsqueeze_4 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Mul_1, {1}}, "i32[1]", {{"special_zero", 0}});   //  /decoder/layers.1/self_attn/Unsqueeze_4
    auto _decoder_layers_1_self_attn_Concat_5 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Unsqueeze_4, {-1}, {80}}, "i32[3]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_5
    auto _decoder_layers_1_self_attn_Reshape_3 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Transpose_2, _decoder_layers_1_self_attn_Concat_5}, "f32[?,?,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_3


    auto _decoder_layers_1_self_attn_Gather1 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {0}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather
    auto _decoder_layers_1_self_attn_Concat = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Gather1, {-1}, {32}, {80}}, "i32[4]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat
    auto _decoder_layers_1_self_attn_Reshape = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_k_proj_Add, _decoder_layers_1_self_attn_Concat}, "f32[?,?,32,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape
    auto _decoder_layers_1_self_attn_Transpose = GenPattern<opset1::Transpose>({_decoder_layers_1_self_attn_Reshape, {0, 2, 1, 3}}, "f32[?,32,?,80]");   //  /decoder/layers.1/self_attn/Transpose
    auto present_1_key = GenPattern<opset1::Concat>({past_key_values_1_key, _decoder_layers_1_self_attn_Transpose}, "f32[?,32,?,80]", {{"axis", 2}});   //  present.1.key
    auto _decoder_layers_1_self_attn_Unsqueeze_5 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Mul_1, {1}}, "i32[1]", {{"special_zero", 0}});   //  /decoder/layers.1/self_attn/Unsqueeze_5
    auto _decoder_layers_1_self_attn_Concat_6 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Unsqueeze_5, {-1}, {80}}, "i32[3]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_6
    auto _decoder_layers_1_self_attn_Reshape_4 = GenPattern<opset1::Reshape>({present_1_key, _decoder_layers_1_self_attn_Concat_6}, "f32[?,?,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_4
    auto _decoder_layers_1_self_attn_MatMul = GenPattern<opset1::MatMul>({_decoder_layers_1_self_attn_Reshape_3, _decoder_layers_1_self_attn_Reshape_4}, "f32[?,?,?]", {{"transpose_a", 0}, {"transpose_b", 1}});   //  /decoder/layers.1/self_attn/MatMul
    auto _decoder_layers_1_self_attn_Gather2 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {0}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather
    auto _decoder_layers_1_self_attn_Gather_1 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {1}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather_1
    auto _decoder_layers_1_self_attn_Shape_2 = GenPattern<opset1::ShapeOf>({_decoder_layers_1_self_attn_Reshape_4}, "i32[3]", {});   //  /decoder/layers.1/self_attn/Shape_2
    auto _decoder_layers_1_self_attn_Gather_2 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape_2, {1}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather_2
    auto _decoder_layers_1_self_attn_Concat_8 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Gather2, {32}, _decoder_layers_1_self_attn_Gather_1, _decoder_layers_1_self_attn_Gather_2}, "i32[4]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_8
    auto _decoder_layers_1_self_attn_Reshape_6 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_MatMul, _decoder_layers_1_self_attn_Concat_8}, "f32[?,32,?,?]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_6
    auto _decoder_layers_1_self_attn_Add = GenPattern<opset1::Add>({_decoder_layers_1_self_attn_Reshape_6, _decoder_Add_2}, "f32[?,32,?,?]", {{"auto_broadcast", "numpy"}});   //  /decoder/layers.1/self_attn/Add
    auto Constant_129564 = GenPattern<opset1::Constant>({/*-3.40282e+38*/}, "f32[1,1,1,1]");
    auto _decoder_layers_1_self_attn_Max = GenPattern<opset1::Maximum>({_decoder_layers_1_self_attn_Add, Constant_129564}, "f32[?,32,?,?]", {{"auto_broadcast", "numpy"}});   //  /decoder/layers.1/self_attn/Max
    auto _decoder_layers_1_self_attn_Unsqueeze_10 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Mul_1, {1}}, "i32[1]", {{"special_zero", 0}});   //  /decoder/layers.1/self_attn/Unsqueeze_10
    auto _decoder_layers_1_self_attn_Gather_11 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {1}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather_1
    auto _decoder_layers_1_self_attn_Gather_21 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape_2, {1}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather_2
    auto _decoder_layers_1_self_attn_Concat_9 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Unsqueeze_10, _decoder_layers_1_self_attn_Gather_11, _decoder_layers_1_self_attn_Gather_21}, "i32[3]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_9
    auto _decoder_layers_1_self_attn_Reshape_7 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Max, _decoder_layers_1_self_attn_Concat_9}, "f32[?,?,?]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_7
    auto _decoder_layers_1_self_attn_Softmax = GenPattern<opset1::Softmax>({_decoder_layers_1_self_attn_Reshape_7}, "f32[?,?,?]", {{"axis", 2}});   //  /decoder/layers.1/self_attn/Softmax

    auto _decoder_layers_1_self_attn_Gather3 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {0}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather
    auto _decoder_layers_1_self_attn_Concat_1 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Gather3, {-1}, {32}, {80}}, "i32[4]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_1
    auto _decoder_layers_1_self_attn_Reshape_1 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_v_proj_Add, _decoder_layers_1_self_attn_Concat_1}, "f32[?,?,32,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_1
    auto _decoder_layers_1_self_attn_Transpose_1 = GenPattern<opset1::Transpose>({_decoder_layers_1_self_attn_Reshape_1, {0, 2, 1, 3}}, "f32[?,32,?,80]");   //  /decoder/layers.1/self_attn/Transpose_1
    auto present_1_value = GenPattern<opset1::Concat>({past_key_values_1_value, _decoder_layers_1_self_attn_Transpose_1}, "f32[?,32,?,80]", {{"axis", 2}});   //  present.1.value
    auto _decoder_layers_1_self_attn_Unsqueeze_6 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Mul_1, {1}}, "i32[1]", {{"special_zero", 0}});   //  /decoder/layers.1/self_attn/Unsqueeze_6
    auto _decoder_layers_1_self_attn_Concat_7 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Unsqueeze_6, {-1}, {80}}, "i32[3]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_7
    auto _decoder_layers_1_self_attn_Reshape_5 = GenPattern<opset1::Reshape>({present_1_value, _decoder_layers_1_self_attn_Concat_7}, "f32[?,?,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_5
    auto _decoder_layers_1_self_attn_MatMul_1 = GenPattern<opset1::MatMul>({_decoder_layers_1_self_attn_Softmax, _decoder_layers_1_self_attn_Reshape_5}, "f32[?,?,80]", {{"transpose_a", 0}, {"transpose_b", 0}});   //  /decoder/layers.1/self_attn/MatMul_1
    auto _decoder_layers_1_self_attn_Gather4 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {0}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather
    auto _decoder_layers_1_self_attn_Gather_12 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {1}, 0}, "i32[1]", {{"batch_dims", 0}});   //  /decoder/layers.1/self_attn/Gather_1
    auto _decoder_layers_1_self_attn_Concat_10 = GenPattern<opset1::Concat>({_decoder_layers_1_self_attn_Gather4, {32}, _decoder_layers_1_self_attn_Gather_12, {80}}, "i32[4]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_10
    auto _decoder_layers_1_self_attn_Reshape_8 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_MatMul_1, _decoder_layers_1_self_attn_Concat_10}, "f32[?,32,?,80]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_8
    auto _decoder_layers_1_self_attn_Transpose_4 = GenPattern<opset1::Transpose>({_decoder_layers_1_self_attn_Reshape_8, {0, 2, 1, 3}}, "f32[?,?,32,80]");   //  /decoder/layers.1/self_attn/Transpose_4
    auto Gather_103555 = GenPattern<opset8::Gather>({_decoder_layers_1_self_attn_Shape, {0, 1}, 0}, "i32[2]", {{"batch_dims", 0}});   //  Gather_103555
    auto _decoder_layers_1_self_attn_Concat_11 = GenPattern<opset1::Concat>({Gather_103555, {2560}}, "i32[3]", {{"axis", 0}});   //  /decoder/layers.1/self_attn/Concat_11
    auto _decoder_layers_1_self_attn_Reshape_9 = GenPattern<opset1::Reshape>({_decoder_layers_1_self_attn_Transpose_4, _decoder_layers_1_self_attn_Concat_11}, "f32[?,?,2560]", {{"special_zero", 1}});   //  /decoder/layers.1/self_attn/Reshape_9

    return {_decoder_layers_1_self_attn_Reshape_9, present_1_key, present_1_value};
}