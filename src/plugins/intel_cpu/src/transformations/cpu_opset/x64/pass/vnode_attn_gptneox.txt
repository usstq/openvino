struct gptneox_attention : public VNodePattern {
    gptneox_attention() : VNodePattern("gptneox_attention") {}
    OutputVector get(const OutputVector& inputs) override {
        int ii = 0;

        auto linear_Add = inputs[ii++];          // f32[?,?,18432]
        auto Convert_past_key = inputs[ii++];   // f32[?,64,?,96]
        auto Convert_past_value = inputs[ii++]; // f32[?,64,?,96]
        auto attn_mask = inputs[ii++];          // "f32[?,1,1,?]"
        auto const_cos_tab = inputs[ii++];      // f32[1,1,2048,24]
        auto const_sin_tab = inputs[ii++];      // f32[1,1,2048,24]
        auto repeat_Tile = inputs[ii++];        // "i32[?,1,?,24]"
        auto ListConstruct_205_Concat = inputs[ii++]; // "i32[4]"

        auto const_6 = GenConst_tril<uint8_t>("u8[...]");

        auto head_cnt = Symbol("head_cnt");
        auto head_size = Symbol("head_size");
        auto rot_dims = Symbol("rot_dims");

        auto ShapeOf_452631 = GenPattern<opset1::ShapeOf>({linear_Add}, "i32[3]");   //  ShapeOf_452631(__module.model.gpt_neox.layers.2.attention.query_key_value/aten::linear/Add)
        auto Gather_271419 = GenPattern<opset8::Gather>({ShapeOf_452631, {0, 1}, {0}}, "i32[2]", {{"batch_dims", 0}});   //  Gather_271419(ShapeOf_452631, Constant_271417, Constant_271418)
        auto ListConstruct_605_Concat = GenPattern<opset1::Concat>({Gather_271419, {head_cnt}, {head_size*3}}, "i32[4]", {{"axis", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_605/Concat(Gather_271419, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_605/Reshape_1, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_605/Reshape_2)
        // reshape "f32[?,?,64,288]" [B,L,H*3*S] => [B,L,H,S+S+S]
        auto view_Reshape = GenPattern<opset1::Reshape>({linear_Add, ListConstruct_605_Concat}, nullptr, {{"special_zero", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::view/Reshape(__module.model.gpt_neox.layers.2.attention.query_key_value/aten::linear/Add, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_605/Concat)
        auto slice_Slice_614 = GenPattern<opset1::StridedSlice>({view_Reshape, {0, 0, 0, head_size}, {0, 0, 0, head_size*2}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_614(__module.model.gpt_neox.layers.2.attention/aten::view/Reshape, Constant_528596, Constant_528599, Constant_528602)
        auto permute_Transpose_615 = GenPattern<opset1::Transpose>({slice_Slice_614, {0, 2, 1, 3}});   //  __module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_615(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_614, 7)
        auto slice_Slice_640 = GenPattern<opset1::StridedSlice>({permute_Transpose_615, {0, 0, 0, 0}, {0, 0, 0, rot_dims}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_640(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_615, Constant_528608, Constant_528611, Constant_528614)

        auto ShapeOf_452659 = GenPattern<opset1::ShapeOf>({permute_Transpose_615}, "i32[4]", {});   //  ShapeOf_452659(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_615)
        auto size_Gather_649 = GenPattern<opset8::Gather>({ShapeOf_452659, {2}, {0}}, nullptr, {{"batch_dims", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::size/Gather_649(ShapeOf_452659, Constant_270150, __module.model.gpt_neox.layers.2.attention/aten::size/Constant_648)
        auto ShapeOf_452660 = GenPattern<opset1::ShapeOf>({Convert_past_key}, "i32[4]", {});   //  ShapeOf_452660(Convert_past_key)
        auto size_Gather_652 = GenPattern<opset8::Gather>({ShapeOf_452660, {2}, {0}}, nullptr, {{"batch_dims", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::size/Gather_652(ShapeOf_452660, 28, __module.model.gpt_neox.layers.2.attention/aten::size/Constant_651)
        auto add__Add = GenPattern<opset1::Add>({size_Gather_649, size_Gather_652}, nullptr, {{"auto_broadcast", "numpy"}});   //  __module.model.gpt_neox.layers.2.attention/aten::add_/Add(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_649, __module.model.gpt_neox.layers.2.attention/aten::size/Gather_652)
        auto rotary_emb_slice_Slice = GenPattern<opset1::StridedSlice>({const_cos_tab, {0}, add__Add, {1}}, nullptr, {{"begin_mask",  {0} }, {"end_mask",  {0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Slice(928, __module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Unsqueeze_654, __module.model.gpt_neox.layers.2.attention/aten::add_/Add, __module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Unsqueeze_656)
        auto repeat_Tile_684 = GenPattern<opset1::Tile>({rotary_emb_slice_Slice, ListConstruct_205_Concat});   //  __module.model.gpt_neox.layers.2.attention/aten::repeat/Tile_684(__module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Slice, __module.model.gpt_neox.layers.0.attention/prim::ListConstruct_205/Concat)
        auto gather_GatherElements = GenPattern<opset6::GatherElements>({repeat_Tile_684, repeat_Tile}, nullptr, {{"axis", 2}});   //  __module.model.gpt_neox.layers.2.attention/aten::gather/GatherElements(__module.model.gpt_neox.layers.2.attention/aten::repeat/Tile_684, __module.model.gpt_neox.layers.0.attention/aten::repeat/Tile)
        auto mul_Multiply_711 = GenPattern<opset1::Multiply>({slice_Slice_640, gather_GatherElements}, nullptr, {{"auto_broadcast", "numpy"}});   //  __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_711(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_640, __module.model.gpt_neox.layers.2.attention/aten::gather/GatherElements)
        auto slice_Slice_729 = GenPattern<opset1::StridedSlice>({slice_Slice_640, {0, 0, 0, rot_dims/2}, {0, 0, 0, 2147483647}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_729(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_640, ScatterUpdate_528622, Constant_528625, Constant_528628)
        auto neg_Multiply_732 = GenPattern<opset1::Multiply>({slice_Slice_729, {-1.0f}}, nullptr, {{"auto_broadcast", "numpy"}});   //  __module.model.gpt_neox.layers.2.attention/aten::neg/Multiply_732(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_729, Constant_603831)
        auto slice_Slice_723 = GenPattern<opset1::StridedSlice>({slice_Slice_640, {0, 0, 0, 0}, {0, 0, 0, rot_dims/2}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_723(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_640, Constant_528686, ScatterUpdate_528688, Constant_528691)
        auto cat_Concat_736 = GenPattern<opset1::Concat>({neg_Multiply_732, slice_Slice_723}, nullptr, {{"axis", -1}});   //  __module.model.gpt_neox.layers.2.attention/aten::cat/Concat_736(__module.model.gpt_neox.layers.2.attention/aten::neg/Multiply_732, __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_723)
        auto rotary_emb_slice_Slice_662 = GenPattern<opset1::StridedSlice>({const_sin_tab, {0}, add__Add, {1}}, nullptr, {{"begin_mask",  {0} }, {"end_mask",  {0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // nullptr, __module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Slice_662(927, __module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Unsqueeze_659, __module.model.gpt_neox.layers.2.attention/aten::add_/Add, __module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Unsqueeze_661)
        auto repeat_Tile_689 = GenPattern<opset1::Tile>({rotary_emb_slice_Slice_662, ListConstruct_205_Concat});   // "f32[?,1,2048,24]" __module.model.gpt_neox.layers.2.attention/aten::repeat/Tile_689(__module.model.gpt_neox.layers.2.attention.rotary_emb/aten::slice/Slice_662, __module.model.gpt_neox.layers.0.attention/prim::ListConstruct_205/Concat)
        auto gather_GatherElements_691 = GenPattern<opset6::GatherElements>({repeat_Tile_689, repeat_Tile}, nullptr, {{"axis", 2}});   // "f32[?,1,?,24]" __module.model.gpt_neox.layers.2.attention/aten::gather/GatherElements_691(__module.model.gpt_neox.layers.2.attention/aten::repeat/Tile_689, __module.model.gpt_neox.layers.0.attention/aten::repeat/Tile)
        auto mul_Multiply_737 = GenPattern<opset1::Multiply>({cat_Concat_736, gather_GatherElements_691}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,24]"  __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_737(__module.model.gpt_neox.layers.2.attention/aten::cat/Concat_736, __module.model.gpt_neox.layers.2.attention/aten::gather/GatherElements_691)
        auto add_Add_740 = GenPattern<opset1::Add>({mul_Multiply_711, mul_Multiply_737}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,24]" __module.model.gpt_neox.layers.2.attention/aten::add/Add_740(__module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_711, __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_737)
        auto slice_Slice_646 = GenPattern<opset1::StridedSlice>({permute_Transpose_615, {0, 0, 0, rot_dims}, {0, 0, 0, 2147483647}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,64,?,72]" __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_646(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_615, Constant_528752, Constant_528755, Constant_528758)
        auto cat_Concat_748 = GenPattern<opset1::Concat>({add_Add_740, slice_Slice_646}, nullptr, {{"axis", -1}});   // "f32[?,64,?,96]" __module.model.gpt_neox.layers.2.attention/aten::cat/Concat_748(__module.model.gpt_neox.layers.2.attention/aten::add/Add_740, __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_646)
        // present_key
        auto Concat_3512 = GenPattern<opset1::Concat>({Convert_past_key, cat_Concat_748}, nullptr, {{"axis", -2}});   // "f32[?,64,?,96]" Concat_3512(Convert_past_key, __module.model.gpt_neox.layers.2.attention/aten::cat/Concat_748)
        auto ShapeOf_452775 = GenPattern<opset1::ShapeOf>({Concat_3512}, "i32[4]", {});   //  ShapeOf_452775(Concat_3512)
        auto size_Gather_771 = GenPattern<opset8::Gather>({ShapeOf_452775, {2}, {0}}, nullptr, {{"batch_dims", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::size/Gather_771(ShapeOf_452775, Constant_359485, __module.model.gpt_neox.layers.2.attention/aten::size/Constant_770)
        auto slice_Slice = GenPattern<opset1::StridedSlice>({view_Reshape, {0, 0, 0, 0}, {0, 0, 0, head_size}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,?,64,96]" __module.model.gpt_neox.layers.2.attention/aten::slice/Slice(__module.model.gpt_neox.layers.2.attention/aten::view/Reshape, Constant_528764, Constant_528767, Constant_528770)
        auto permute_Transpose = GenPattern<opset1::Transpose>({slice_Slice, {0, 2, 1, 3}});   // "f32[?,64,?,96]" __module.model.gpt_neox.layers.2.attention/aten::permute/Transpose(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice, 7)
        auto slice_Slice_628 = GenPattern<opset1::StridedSlice>({permute_Transpose, {0, 0, 0, 0}, {0, 0, 0, rot_dims}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,64,?,24]" __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_628(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose, Constant_528776, Constant_528779, Constant_528782)
        auto mul_Multiply = GenPattern<opset1::Multiply>({slice_Slice_628, gather_GatherElements}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,24]"  __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_628, __module.model.gpt_neox.layers.2.attention/aten::gather/GatherElements)
        auto slice_Slice_706 = GenPattern<opset1::StridedSlice>({slice_Slice_628, {0, 0, 0, rot_dims/2}, {0, 0, 0, 2147483647}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,64,?,12]" __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_706(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_628, ScatterUpdate_528787, Constant_528790, Constant_528793)

        auto neg_Multiply = GenPattern<opset1::Multiply>({slice_Slice_706, {-1}}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,12]" __module.model.gpt_neox.layers.2.attention/aten::neg/Multiply(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_706, Constant_603832)
        auto slice_Slice_700 = GenPattern<opset1::StridedSlice>({slice_Slice_628, {0, 0, 0, 0}, {0, 0, 0, rot_dims/2}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,64,?,12]" __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_700(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_628, Constant_528851, ScatterUpdate_528853, Constant_528856)
        auto cat_Concat = GenPattern<opset1::Concat>({neg_Multiply, slice_Slice_700}, nullptr, {{"axis", -1}});   // "f32[?,64,?,24]" __module.model.gpt_neox.layers.2.attention/aten::cat/Concat(__module.model.gpt_neox.layers.2.attention/aten::neg/Multiply, __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_700)
        auto mul_Multiply_710 = GenPattern<opset1::Multiply>({cat_Concat, gather_GatherElements_691}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,24]" __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_710(__module.model.gpt_neox.layers.2.attention/aten::cat/Concat, __module.model.gpt_neox.layers.2.attention/aten::gather/GatherElements_691)
        auto add_Add = GenPattern<opset1::Add>({mul_Multiply, mul_Multiply_710}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,24]" __module.model.gpt_neox.layers.2.attention/aten::add/Add(__module.model.gpt_neox.layers.2.attention/aten::mul/Multiply, __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_710)
        auto slice_Slice_634 = GenPattern<opset1::StridedSlice>({permute_Transpose, {0, 0, 0, rot_dims}, {0, 0, 0, 2147483647}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,64,?,72]" __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_634(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose, Constant_528914, Constant_528917, Constant_528920)
        auto cat_Concat_744 = GenPattern<opset1::Concat>({add_Add, slice_Slice_634}, nullptr, {{"axis", -1}});   // "f32[?,64,?,96]" __module.model.gpt_neox.layers.2.attention/aten::cat/Concat_744(__module.model.gpt_neox.layers.2.attention/aten::add/Add, __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_634)
        auto ShapeOf_452778 = GenPattern<opset1::ShapeOf>({cat_Concat_744}, "i32[4]", {});   //  ShapeOf_452778(__module.model.gpt_neox.layers.2.attention/aten::cat/Concat_744)
        auto size_Gather_765 = GenPattern<opset8::Gather>({ShapeOf_452778, {2}, {0}}, nullptr, {{"batch_dims", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::size/Gather_765(ShapeOf_452778, 28, __module.model.gpt_neox.layers.2.attention/aten::size/Constant_764)
        auto Multiply_359487 = GenPattern<opset1::Multiply>({size_Gather_765, -1}, nullptr, {{"auto_broadcast", "numpy"}});   //  Multiply_359487(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_765, Constant_359486)
        auto sub_Subtract = GenPattern<opset1::Add>({size_Gather_771, Multiply_359487}, nullptr, {{"auto_broadcast", "numpy"}});   //  __module.model.gpt_neox.layers.2.attention/aten::sub/Subtract(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_771, Multiply_359487)
        auto slice_Unsqueeze_775 = GenPattern<opset1::Reshape>({sub_Subtract, {1}}, nullptr, {{"special_zero", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Unsqueeze_775(__module.model.gpt_neox.layers.2.attention/aten::sub/Subtract, Constant_291313)
        auto ScatterUpdate_528925 = GenPattern<opset3::ScatterUpdate>({{0, 0, 0}, {2}, slice_Unsqueeze_775, {0}}, "i32[3]");   //  ScatterUpdate_528925(Constant_528924, Constant_528923, __module.model.gpt_neox.layers.2.attention/aten::slice/Unsqueeze_775, Constant_528922)
        auto size_Gather_7710 = GenPattern<opset8::Gather>({ShapeOf_452775, {2}, {0}}, nullptr, {{"batch_dims", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::size/Gather_7710(ShapeOf_452775, Constant_359554, __module.model.gpt_neox.layers.2.attention/aten::size/Constant_770)
        
        auto reshape_1ele = [](std::shared_ptr<Node> in) {
            return GenPattern<opset1::Reshape>({in, {1}}, "i32[1]", {{"special_zero", 0}}) | in;
        };

        auto ScatterUpdate_528927 = GenPattern<opset3::ScatterUpdate>({{0, 0, 0}, {2}, reshape_1ele(size_Gather_7710), {0}}, "i32[3]");   //  ScatterUpdate_528927(Constant_528926, Constant_528923, __module.model.gpt_neox.layers.2.attention/aten::size/Gather_7710, Constant_528922)
        auto slice_Slice_778 = GenPattern<opset1::StridedSlice>({const_6, ScatterUpdate_528925, ScatterUpdate_528927, {1, 1, 1}}, "u8[1,1,..2048,2048]", {{"begin_mask",  {1,1,0} }, {"end_mask",  {1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_778(6, ScatterUpdate_528925, ScatterUpdate_528927, Constant_528930)
        auto ScatterUpdate_529078 = GenPattern<opset3::ScatterUpdate>({{0, 0, 0, 0}, {3}, reshape_1ele(size_Gather_7710), {0}}, "i32[4]");   //  ScatterUpdate_529078(Constant_529077, Constant_529073, __module.model.gpt_neox.layers.2.attention/aten::size/Gather_7710, Constant_529072)
        auto slice_Slice_784 = GenPattern<opset1::StridedSlice>({slice_Slice_778, {0, 0, 0, 0}, ScatterUpdate_529078, {1, 1, 1, 1}}, "u8[1,1,..2048,..2048]", {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   //  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_784(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_778, Constant_529076, ScatterUpdate_529078, Constant_529081)
        auto size_Gather_759 = GenPattern<opset8::Gather>({ShapeOf_452778, {0}, {0}}, nullptr, {{"batch_dims", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::size/Gather_759(ShapeOf_452778, 37, __module.model.gpt_neox.layers.2.attention/aten::size/Constant_758)
        auto mul_Multiply_785 = GenPattern<opset1::Multiply>({size_Gather_759, head_cnt}, nullptr, {{"auto_broadcast", "numpy"}});   //  __module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_785(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_759, __module.model.gpt_neox.layers.2.attention/aten::size/Gather_762)
        auto ListConstruct_797_Reshape = GenPattern<opset1::Reshape>({mul_Multiply_785, {-1}}, nullptr, {{"special_zero", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape(__module.model.gpt_neox.layers.2.attention/aten::mul/Multiply_785, Constant_102151)
        auto ListConstruct_797_Reshape_0 = GenPattern<opset1::Reshape>({size_Gather_765, {-1}}, nullptr, {{"special_zero", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_0(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_765, Constant_102152)
        auto ListConstruct_789_Concat = GenPattern<opset1::Concat>({ListConstruct_797_Reshape, ListConstruct_797_Reshape_0, {head_size}}, "i32[3]", {{"axis", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_789/Concat(__module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_0, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_789/Reshape_1)
        auto view_Reshape_790 = GenPattern<opset1::Reshape>({cat_Concat_744, ListConstruct_789_Concat}, nullptr, {{"special_zero", 0}});   // "f32[?,?,96]" __module.model.gpt_neox.layers.2.attention/aten::view/Reshape_790(__module.model.gpt_neox.layers.2.attention/aten::cat/Concat_744, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_789/Concat)
        auto Multiply_513371 = GenPattern<opset1::Multiply>({Concat_3512, {1.0f/sqrt(head_size)}}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,96]" Multiply_513371(Concat_3512, Constant_513370)
        auto ListConstruct_797_Reshape_1 = GenPattern<opset1::Reshape>({size_Gather_771, {-1}}, nullptr, {{"special_zero", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_1(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_771, Constant_102153)
        auto ListConstruct_793_Concat = GenPattern<opset1::Concat>({ListConstruct_797_Reshape, ListConstruct_797_Reshape_1, {head_size}}, "i32[3]", {{"axis", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_793/Concat(__module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_1, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_793/Reshape_1)
        auto view_Reshape_794 = GenPattern<opset1::Reshape>({Multiply_513371, ListConstruct_793_Concat}, nullptr, {{"special_zero", 0}});   // "f32[?,?,96]" __module.model.gpt_neox.layers.2.attention/aten::view/Reshape_794(Multiply_513371, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_793/Concat)
        auto transpose_Transpose = GenPattern<opset1::Transpose>({view_Reshape_794, {0, 2, 1}});   // "f32[?,96,?]" __module.model.gpt_neox.layers.2.attention/aten::transpose/Transpose(__module.model.gpt_neox.layers.2.attention/aten::view/Reshape_794, __module.model.gpt_neox.layers.2.attention/aten::transpose/ScatterElementsUpdate)
        // Q*K'
        auto baddbmm_Multiply_805 = GenPattern<opset1::MatMul>({view_Reshape_790, transpose_Transpose}, "f32[?,?,?]", {{"transpose_a", 0}, {"transpose_b", 0}});   //  __module.model.gpt_neox.layers.2.attention/aten::baddbmm/Multiply_805(__module.model.gpt_neox.layers.2.attention/aten::view/Reshape_790, __module.model.gpt_neox.layers.2.attention/aten::transpose/Transpose)
        auto ShapeOf_453192 = GenPattern<opset1::ShapeOf>({baddbmm_Multiply_805}, "i32[3]", {});   //  ShapeOf_453192(__module.model.gpt_neox.layers.2.attention/aten::baddbmm/Multiply_805)
        auto ListConstruct_797_Concat = GenPattern<opset1::Concat>({ListConstruct_797_Reshape, ListConstruct_797_Reshape_0, ListConstruct_797_Reshape_1}, "i32[3]", {{"axis", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Concat(__module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_0, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_1)
        auto Maximum_220603 = GenPattern<opset1::Maximum>({ShapeOf_453192, ListConstruct_797_Concat}, "i32[3]", {{"auto_broadcast", "numpy"}});   //  Maximum_220603(ShapeOf_453192, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Concat)
        auto baddbmm_Add = GenPattern<opset1::Broadcast>({baddbmm_Multiply_805, Maximum_220603, {0}}, "f32[?,?,?]", {{"mode", "numpy"}});   //  __module.model.gpt_neox.layers.2.attention/aten::baddbmm/Add(__module.model.gpt_neox.layers.2.attention/aten::baddbmm/Multiply_805, Maximum_220603, Constant_426295)
        auto ListConstruct_808_Reshape = GenPattern<opset1::Reshape>({size_Gather_759, {-1}}, nullptr, {{"special_zero", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_808/Reshape(__module.model.gpt_neox.layers.2.attention/aten::size/Gather_759, Constant_102160)
        auto ListConstruct_808_Concat = GenPattern<opset1::Concat>({ListConstruct_808_Reshape, {head_cnt}, ListConstruct_797_Reshape_0, ListConstruct_797_Reshape_1}, "i32[4]", {{"axis", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_808/Concat(__module.model.gpt_neox.layers.2.attention/prim::ListConstruct_808/Reshape, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_808/Reshape_0, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_0, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_797/Reshape_1)
        auto view_Reshape_809 = GenPattern<opset1::Reshape>({baddbmm_Add, ListConstruct_808_Concat}, nullptr, {{"special_zero", 0}});   // "f32[?,64,?,?]" __module.model.gpt_neox.layers.2.attention/aten::view/Reshape_809(__module.model.gpt_neox.layers.2.attention/aten::baddbmm/Add, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_808/Concat)
        auto where_Select = GenPattern<opset1::Select>({slice_Slice_784, view_Reshape_809, {-FLT_MAX}}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,?]" __module.model.gpt_neox.layers.2.attention/aten::where/Select(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_784, __module.model.gpt_neox.layers.2.attention/aten::view/Reshape_809, 4)
        auto add_Add_812 = GenPattern<opset1::Add>({where_Select, attn_mask}, nullptr, {{"auto_broadcast", "numpy"}});   // "f32[?,64,?,?]" __module.model.gpt_neox.layers.2.attention/aten::add/Add_812(__module.model.gpt_neox.layers.2.attention/aten::where/Select, __module.model.gpt_neox/aten::mul/Multiply)
        auto softmax_Softmax = GenPattern<opset1::Softmax>({add_Add_812}, nullptr, {{"axis", 3}});   // "f32[?,64,?,?]" __module.model.gpt_neox.layers.2.attention/aten::softmax/Softmax(__module.model.gpt_neox.layers.2.attention/aten::add/Add_812)

        // value
        auto slice_Slice_621 = GenPattern<opset1::StridedSlice>({view_Reshape, {0, 0, 0, head_size*2}, {0, 0, 0, 2147483647}, {1, 1, 1, 1}}, nullptr, {{"begin_mask",  {1,1,1,0} }, {"end_mask",  {1,1,1,0} }, {"new_axis_mask",  {} }, {"shrink_axis_mask",  {} }, {"ellipsis_mask",  {} }});   // "f32[?,?,64,96]"  __module.model.gpt_neox.layers.2.attention/aten::slice/Slice_621(__module.model.gpt_neox.layers.2.attention/aten::view/Reshape, Constant_529093, Constant_529096, Constant_529099)
        auto permute_Transpose_622 = GenPattern<opset1::Transpose>({slice_Slice_621, {0, 2, 1, 3}});   // "f32[?,64,?,96]" __module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_622(__module.model.gpt_neox.layers.2.attention/aten::slice/Slice_621, 7)
        // present value
        auto Concat_4196 = GenPattern<opset1::Concat>({Convert_past_value, permute_Transpose_622}, nullptr, {{"axis", -2}});   //"f32[?,64,?,96]"  Concat_4196(Convert_72299, __module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_622)
        auto matmul_MatMul = GenPattern<opset1::MatMul>({softmax_Softmax, Concat_4196}, nullptr, {{"transpose_a", 0}, {"transpose_b", 0}});   // "f32[?,64,?,96]"  __module.model.gpt_neox.layers.2.attention/aten::matmul/MatMul(__module.model.gpt_neox.layers.2.attention/aten::softmax/Softmax, Concat_4196)
        auto permute_Transpose_813 = GenPattern<opset1::Transpose>({matmul_MatMul, {0, 2, 1, 3}});   // "f32[?,?,64,96]"  __module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_813(__module.model.gpt_neox.layers.2.attention/aten::matmul/MatMul, 7)
        auto ShapeOf_453437 = GenPattern<opset1::ShapeOf>({permute_Transpose_813}, "i32[4]", {});   //  ShapeOf_453437(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_813)
        auto Gather_271424 = GenPattern<opset8::Gather>({ShapeOf_453437, {0, 1}, {0}}, "i32[2]", {{"batch_dims", 0}});   //  Gather_271424(ShapeOf_453437, Constant_271422, Constant_271423)
        auto ListConstruct_822_Concat = GenPattern<opset1::Concat>({Gather_271424, {head_cnt*head_size}}, "i32[3]", {{"axis", 0}});   //  __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_822/Concat(Gather_271424, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_822/Reshape_1)
        auto view_Reshape_823 = GenPattern<opset1::Reshape>({permute_Transpose_813, ListConstruct_822_Concat}, nullptr, {{"special_zero", 0}});   // "f32[?,?,6144]" __module.model.gpt_neox.layers.2.attention/aten::view/Reshape_823(__module.model.gpt_neox.layers.2.attention/aten::permute/Transpose_813, __module.model.gpt_neox.layers.2.attention/prim::ListConstruct_822/Concat)

        return {view_Reshape_823, Concat_3512, Concat_4196};
    }
};